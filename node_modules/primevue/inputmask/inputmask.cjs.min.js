"use strict";var e=require("primevue/utils"),t=require("primevue/basecomponent"),i=require("primevue/inputmask/style"),s=require("vue");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a={name:"InputMask",extends:{name:"BaseInputMask",extends:n(t).default,props:{modelValue:null,slotChar:{type:String,default:"_"},mask:{type:String,default:null},autoClear:{type:Boolean,default:!0},unmask:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},invalid:{type:Boolean,default:!1},variant:{type:String,default:null}},style:n(i).default},inheritAttrs:!1,emits:["update:modelValue","focus","blur","keydown","complete","keypress","paste"],watch:{mask:function(e,t){t!==e&&this.initMask()}},mounted:function(){this.initMask()},updated:function(){this.isValueUpdated()&&this.updateValue()},methods:{onInput:function(e){this.androidChrome?this.handleAndroidInput(e):this.handleInputChange(e),this.$emit("update:modelValue",e.target.value)},onFocus:function(e){var t,i=this;this.readonly||(this.focus=!0,clearTimeout(this.caretTimeoutId),this.focusText=this.$el.value,t=this.checkVal(),this.caretTimeoutId=setTimeout((function(){i.$el===document.activeElement&&(i.writeBuffer(),t===i.mask.replace("?","").length?i.caret(0,t):i.caret(t))}),10),this.$emit("focus",e))},onBlur:function(e){if(this.focus=!1,this.checkVal(),this.updateModel(e),this.$el.value!==this.focusText){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.$el.dispatchEvent(t)}this.$emit("blur",e)},onKeyDown:function(t){if(!this.readonly){var i,s,n,a=t.code,l=/iphone/i.test(e.DomHandler.getUserAgent());this.oldVal=this.$el.value,"Backspace"===a||"Delete"===a||l&&"Escape"===a?((n=(i=this.caret()).end)-(s=i.begin)==0&&(s="Delete"!==a?this.seekPrev(s):n=this.seekNext(s-1),n="Delete"===a?this.seekNext(n):n),this.clearBuffer(s,n),this.shiftL(s,n-1),this.updateModel(t),t.preventDefault()):"Enter"===a?(this.$el.blur(),this.updateModel(t)):"Escape"===a&&(this.$el.value=this.focusText,this.caret(0,this.checkVal()),this.updateModel(t),t.preventDefault()),this.$emit("keydown",t)}},onKeyPress:function(t){var i=this;if(!this.readonly){var s,n,a,l,h=t.code,r=this.caret();if(!(t.ctrlKey||t.altKey||t.metaKey||t.shiftKey||"CapsLock"===t.key||"Escape"===t.key||"Tab"===t.key)){if(h&&"Enter"!==h){if(r.end-r.begin!=0&&(this.clearBuffer(r.begin,r.end),this.shiftL(r.begin,r.end-1)),(s=this.seekNext(r.begin-1))<this.len&&this.tests[s].test(n=t.key)){if(this.shiftR(s),this.buffer[s]=n,this.writeBuffer(),a=this.seekNext(s),/android/i.test(e.DomHandler.getUserAgent())){setTimeout((function(){i.caret(a)}),0)}else this.caret(a);r.begin<=this.lastRequiredNonMaskPos&&(l=this.isCompleted())}t.preventDefault()}this.updateModel(t),l&&this.$emit("complete",t),this.$emit("keypress",t)}}},onPaste:function(e){this.handleInputChange(e),this.$emit("paste",e)},caret:function(e,t){var i,s,n;if(this.$el.offsetParent&&this.$el===document.activeElement)return"number"!=typeof e?(this.$el.setSelectionRange?(s=this.$el.selectionStart,n=this.$el.selectionEnd):document.selection&&document.selection.createRange&&(n=(s=0-(i=document.selection.createRange()).duplicate().moveStart("character",-1e5))+i.text.length),{begin:s,end:n}):(s=e,n="number"==typeof t?t:s,void(this.$el.setSelectionRange?this.$el.setSelectionRange(s,n):this.$el.createTextRange&&((i=this.$el.createTextRange()).collapse(!0),i.moveEnd("character",n),i.moveStart("character",s),i.select())))},isCompleted:function(){for(var e=this.firstNonMaskPos;e<=this.lastRequiredNonMaskPos;e++)if(this.tests[e]&&this.buffer[e]===this.getPlaceholder(e))return!1;return!0},getPlaceholder:function(e){return this.slotChar.charAt(e<this.slotChar.length?e:0)},seekNext:function(e){for(;++e<this.len&&!this.tests[e];);return e},seekPrev:function(e){for(;--e>=0&&!this.tests[e];);return e},shiftL:function(e,t){var i,s;if(!(e<0)){for(i=e,s=this.seekNext(t);i<this.len;i++)if(this.tests[i]){if(!(s<this.len&&this.tests[i].test(this.buffer[s])))break;this.buffer[i]=this.buffer[s],this.buffer[s]=this.getPlaceholder(s),s=this.seekNext(s)}this.writeBuffer(),this.caret(Math.max(this.firstNonMaskPos,e))}},shiftR:function(e){var t,i,s,n;for(t=e,i=this.getPlaceholder(e);t<this.len;t++)if(this.tests[t]){if(s=this.seekNext(t),n=this.buffer[t],this.buffer[t]=i,!(s<this.len&&this.tests[s].test(n)))break;i=n}},handleAndroidInput:function(e){var t=this.$el.value,i=this.caret();if(this.oldVal&&this.oldVal.length&&this.oldVal.length>t.length){for(this.checkVal(!0);i.begin>0&&!this.tests[i.begin-1];)i.begin--;if(0===i.begin)for(;i.begin<this.firstNonMaskPos&&!this.tests[i.begin];)i.begin++;this.caret(i.begin,i.begin)}else{for(this.checkVal(!0);i.begin<this.len&&!this.tests[i.begin];)i.begin++;this.caret(i.begin,i.begin)}this.isCompleted()&&this.$emit("complete",e)},clearBuffer:function(e,t){var i;for(i=e;i<t&&i<this.len;i++)this.tests[i]&&(this.buffer[i]=this.getPlaceholder(i))},writeBuffer:function(){this.$el.value=this.buffer.join("")},checkVal:function(e){this.isValueChecked=!0;var t,i,s,n=this.$el.value,a=-1;for(t=0,s=0;t<this.len;t++)if(this.tests[t]){for(this.buffer[t]=this.getPlaceholder(t);s++<n.length;)if(i=n.charAt(s-1),this.tests[t].test(i)){this.buffer[t]=i,a=t;break}if(s>n.length){this.clearBuffer(t+1,this.len);break}}else this.buffer[t]===n.charAt(s)&&s++,t<this.partialPosition&&(a=t);return e?this.writeBuffer():a+1<this.partialPosition?this.autoClear||this.buffer.join("")===this.defaultBuffer?(this.$el.value&&(this.$el.value=""),this.clearBuffer(0,this.len)):this.writeBuffer():(this.writeBuffer(),this.$el.value=this.$el.value.substring(0,a+1)),this.partialPosition?t:this.firstNonMaskPos},handleInputChange:function(e){if(!this.readonly&&!("paste"===e.type)){var t=this.checkVal(!0);this.caret(t),this.updateModel(e),this.isCompleted()&&this.$emit("complete",e)}},getUnmaskedValue:function(){for(var e=[],t=0;t<this.buffer.length;t++){var i=this.buffer[t];this.tests[t]&&i!==this.getPlaceholder(t)&&e.push(i)}return e.join("")},updateModel:function(e){var t=this.unmask?this.getUnmaskedValue():e.target.value;this.$emit("update:modelValue",this.defaultBuffer!==t?t:"")},updateValue:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$el&&(null==this.modelValue?(this.$el.value="",t&&this.$emit("update:modelValue","")):(this.$el.value=this.modelValue,this.checkVal(),setTimeout((function(){if(e.$el&&(e.writeBuffer(),e.checkVal(),t)){var i=e.unmask?e.getUnmaskedValue():e.$el.value;e.$emit("update:modelValue",e.defaultBuffer!==i?i:"")}}),10)),this.focusText=this.$el.value)},initMask:function(){this.tests=[],this.partialPosition=this.mask.length,this.len=this.mask.length,this.firstNonMaskPos=null,this.defs={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"};var t=e.DomHandler.getUserAgent();this.androidChrome=/chrome/i.test(t)&&/android/i.test(t);for(var i=this.mask.split(""),s=0;s<i.length;s++){var n=i[s];"?"===n?(this.len--,this.partialPosition=s):this.defs[n]?(this.tests.push(new RegExp(this.defs[n])),null===this.firstNonMaskPos&&(this.firstNonMaskPos=this.tests.length-1),s<this.partialPosition&&(this.lastRequiredNonMaskPos=this.tests.length-1)):this.tests.push(null)}this.buffer=[];for(var a=0;a<i.length;a++){var l=i[a];"?"!==l&&this.buffer.push(this.defs[l]?this.getPlaceholder(a):l)}this.defaultBuffer=this.buffer.join(""),this.updateValue(!1)},isValueUpdated:function(){return this.unmask?this.modelValue!=this.getUnmaskedValue():this.defaultBuffer!==this.$el.value&&this.$el.value!==this.modelValue}},computed:{filled:function(){return null!=this.modelValue&&this.modelValue.toString().length>0},ptmParams:function(){return{context:{filled:this.filled,disabled:this.$attrs.disabled||""===this.$attrs.disabled}}}}},l=["readonly","aria-invalid"];a.render=function(e,t,i,n,a,h){return s.openBlock(),s.createElementBlock("input",s.mergeProps({class:e.cx("root"),readonly:e.readonly,"aria-invalid":e.invalid||void 0,onInput:t[0]||(t[0]=function(){return h.onInput&&h.onInput.apply(h,arguments)}),onFocus:t[1]||(t[1]=function(){return h.onFocus&&h.onFocus.apply(h,arguments)}),onBlur:t[2]||(t[2]=function(){return h.onBlur&&h.onBlur.apply(h,arguments)}),onKeydown:t[3]||(t[3]=function(){return h.onKeyDown&&h.onKeyDown.apply(h,arguments)}),onKeypress:t[4]||(t[4]=function(){return h.onKeyPress&&h.onKeyPress.apply(h,arguments)}),onPaste:t[5]||(t[5]=function(){return h.onPaste&&h.onPaste.apply(h,arguments)})},e.ptmi("root",h.ptmParams)),null,16,l)},module.exports=a;
